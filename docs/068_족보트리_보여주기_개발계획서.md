# 068_족보트리 보여주기 개발계획서

프로젝트: 한양조씨 족보앱 - 패밀리 트리(가계도) 표시 모듈  
문서번호: 068  
작성일: 2025-09-18  
작성자: 서대리 (Cursor AI)

---

## 1. 목적과 범위
- 목적: window.CORE_DATA를 기반으로 Line별(1/2/3) 가계도를 브라우저에서 가볍고 안정적으로 표현
- 범위: 모바일 우선, 데스크톱 대응, 1~6세대 요약, 이름(생년) 중심, 상세 화면 이동
- 제외: 실시간 편집/드래그 그래프/서버 렌더링(후순위)

## 2. 기준 원칙(10대 원칙 반영)
1) 단일소스(window.CORE_DATA)  2) 최소개발  3) 복사우선 재사용  4) 불변 데이터  
5) 무결성 보정(기본값)  6) 단계 통과 후 진행  7) 모바일 우선  8) 오류 격리  
9) 상태 가시성  10) 단계별 문서화

## 3. 산출 화면(최소)
- L2-2-2 family-tree.html: 라인 선택, 세대 토글(1~6), 보기 전환(표/카드), 목록 클릭 시 detail.html 이동, PDF 저장 버튼

## 4. 데이터 요약
- 인물: { id, name, generation(1~6), line('Line1'|'Line2'|'Line3'|'공통'), birthYear? }
- 누락 값은 표시 생략 또는 '?' 처리

## 5. 단계별 개발 계획(체크리스트)

### Phase A: 뼈대
- [ ] A1. app/family-tree.html · css/family-tree.css · js/family_tree.js 생성
- [ ] A2. CORE 로딩 유틸 재사용(app.js 참고)
- [ ] A3. 그룹화(Line×세대 맵) 생성
- [ ] A4. 데스크톱 표 렌더
- [ ] A5. 모바일 카드 렌더(미디어쿼리)
- [ ] A6. 빈/오류 상태 처리

### Phase B: 상호작용
- [ ] B1. 라인 토글(Line1/2/3)
- [ ] B2. 세대 멀티 선택(1~6, 전체)
- [ ] B3. 보기 전환(표↔카드)
- [ ] B4. 인물 클릭 → detail.html?id=...

### Phase C: 품질/성능
- [ ] C1. 정렬(이름 가나다, 생년 오름)
- [ ] C2. 세대별 접기/펼치기(더보기)
- [ ] C3. 300+ 항목 지연 렌더(간단 가상화)
- [ ] C4. 접근성(포커스, ARIA)

### Phase D: 인쇄/PDF(선택)
- [ ] D1. @media print, @page A4 가로
- [ ] D2. Line별 페이지 분리(page-break)
- [ ] D3. PDF로 저장(window.print())

### Phase E: 통합
- [ ] E1. 대문/패밀리 메뉴 연결
- [ ] E2. 헤더/테마 일관화
- [ ] E3. 예외 배너 연동(데이터 변경 시 알림)

## 6. 테스트 계획
- 유닛/동작
  - [ ] T1. 그룹화 카운트 검증(Line×세대 합)
  - [ ] T2. 세대 토글 DOM 수 변화 확인
  - [ ] T3. 상세 화면 이동 파라미터 확인
- 스모크
  - [ ] S1. 모바일 카드 가독성(iOS/Android)
  - [ ] S2. 데스크톱 표 + 인쇄 미리보기
  - [ ] S3. 라인/세대 조합 랜덤 3케이스
- 회귀
  - [ ] R1. 대표 20인 노출 확인

## 7. 디버깅 가이드
- 콘솔 에러 0원칙. generation 누락 → '?세대' 표기, line 누락 → '공통' 그룹. 이름 누락 → 스킵+집계 경고.
- 300+ 항목 시 기본 접기.

## 8. 문서화/운영
- 완료 시 docs/069_족보트리_개발경과및결과보고서.md 제출(구현/스크린샷/이슈/레슨)

## 9. 코드 스케치
```javascript
function groupByLineGen(core){
	const lines=['Line1','Line2','Line3'];
	const out=Object.fromEntries(lines.map(L=>[L,{1:[],2:[],3:[],4:[],5:[],6:[]}]));
	for(const p of core){
		const L=lines.includes(p.line)?p.line:'Line1';
		const g=Number(p.세대||p.generation)||1;
		const birth=p.birthYear||p.birthDate||'';
		out[L][g].push({id:p.id,text:birth?`${p.name}(${birth})`:p.name});
	}
	for(const L of lines) for(const g of [1,2,3,4,5,6]) out[L][g].sort((a,b)=>a.text.localeCompare(b.text));
	return out;
}
```

## 10. 일정(제안)
- Day1: Phase A  
- Day2: Phase B  
- Day3: Phase C  
- Day4: Phase D  
- Day5: Phase E/테스트/문서화

## 11. 완료 기준(DoD)
- A~E 95% 이상 체크, 모바일/데스크톱 정상, 인쇄 시 라인별 페이지, 콘솔 에러 0, 결과 문서 제출

문서 버전: v1.0  
최종 수정일: 2025-09-18
