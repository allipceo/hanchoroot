# 4단계 패밀리별 보기 기능 세부개발계획서

**작성일**: 2025년 1월 17일  
**작성자**: 서대리  
**단계**: 4단계 - 패밀리별 보기 기능  
**문서번호**: 034  
**문서 버전**: V2.0 (152명 완전 데이터 기반)

---

## 📋 **개발 개요**

### **목표**
- **Line별, 세대별로 가족 구성원을 분류**하여 표시하는 기능 구현
- **가족 트리 형태의 시각적 표현**으로 가족 관계 파악 용이성 제공
- **실제 노션 데이터 152명**을 활용한 완전한 패밀리별 보기 시스템 구축
- **1세대~6세대, Line1~Line3, 공통** 모든 분류 체계 지원

### **핵심 가치**
- **실용성 우선**: 당장 사용 가능한 기능 구현
- **간결함과 재활용성**: 1-3단계 구조 최대 활용
- **모바일 최적화**: 터치 친화적 인터페이스
- **완전한 데이터 기반**: 152명 실제 노션 데이터 활용

### **실제 데이터 현황**
- **총 인물 수**: 152명
- **세대별 분포**: 1세대(3명), 2세대(5명), 3세대(16명), 4세대(47명), 5세대(76명), 6세대(5명)
- **Line별 분포**: Line1(74명), Line2(34명), Line3(41명), 공통(3명)

---

## 🎯 **기능 명세**

### **4-1: 패밀리별 보기 화면 설계**

#### **화면 구성 (실제 데이터 반영)**
```
┌─────────────────────────────────────┐
│ ← 뒤로  🏠 홈    📱 패밀리별 보기    │
├─────────────────────────────────────┤
│ [Line1] [Line2] [Line3] [공통]      │
├─────────────────────────────────────┤
│ [1세대] [2세대] [3세대] [4세대] [5세대] [6세대] [전체] │
├─────────────────────────────────────┤
│                                     │
│  👤 조정윤 (1세대, 공통) 💚         │
│     ├─ 👤 조병희 (2세대, Line1) 💚  │
│     │   ├─ 👤 조영하 (3세대, Line2) 💚 │
│     │   └─ 👤 조명하 (3세대, Line2) 💚 │
│     └─ 👤 조병갑 (2세대, Line3) 💚  │
│                                     │
│  👤 이천경 (1세대, 공통) 💚         │
│     └─ 👤 강부인 (2세대, Line1) 💚  │
│                                     │
└─────────────────────────────────────┘
```

#### **UI 컴포넌트**
1. **Line 탭**: Line1, Line2, Line3, 공통 (4개 탭)
2. **세대 필터**: 1세대, 2세대, 3세대, 4세대, 5세대, 6세대, 전체 (7개 필터)
3. **가족 트리 뷰**: 계층적 구조로 가족 관계 표시
4. **인물 카드**: 이름, 세대, Line, 상태 표시
5. **통계 정보**: 선택된 Line/세대별 인물 수 표시

---

## 🏗️ **기술 아키텍처**

### **데이터 구조**
```javascript
// 4단계 전용 데이터 구조
const FAMILY_VIEW_DATA = {
  // Line별 분류
  byLine: {
    Line1: [...], // 74명
    Line2: [...], // 34명
    Line3: [...], // 41명
    공통: [...]   // 3명
  },
  
  // 세대별 분류
  byGeneration: {
    1: [...], // 3명
    2: [...], // 5명
    3: [...], // 16명
    4: [...], // 47명
    5: [...], // 76명
    6: [...]  // 5명
  },
  
  // 가족 관계 트리
  familyTree: {
    // 1세대 (조정윤, 이천경, 임정숙)
    generation1: {
      조정윤: {
        children: ['조병희', '조병갑'],
        spouses: ['이천경']
      },
      이천경: {
        children: ['강부인'],
        spouses: ['조정윤']
      },
      임정숙: {
        children: [],
        spouses: []
      }
    },
    // 2세대~6세대 관계도...
  }
};
```

### **모듈 구조**
```
data/
├── core.js                    # 기존 1-3단계 데이터
├── family.js                  # 4단계 패밀리별 보기 전용 데이터
├── family-tree.js             # 가족 관계 트리 생성 로직
└── family-filters.js          # Line/세대별 필터링 로직

ui/
├── family.html                # 패밀리별 보기 메인 화면
├── family.css                 # 패밀리별 보기 스타일
└── family.js                  # 패밀리별 보기 로직

system/
├── family-navigation.js       # Line/세대 탭 네비게이션
├── family-tree-renderer.js    # 가족 트리 렌더링
└── family-statistics.js       # 통계 정보 표시
```

---

## 🔧 **개발 단계별 계획**

### **Phase 1: 데이터 준비 및 구조 설계 (1시간)**

#### **1-1. Core Module 업데이트**
```javascript
// data/core.js 업데이트
const notionData = JSON.parse(fs.readFileSync('./converted_complete_data.json', 'utf8'));
```

#### **1-2. 패밀리별 보기 전용 데이터 모듈 생성**
```javascript
// data/family.js
const FAMILY_DATA = {
  // 152명 데이터를 Line별, 세대별로 분류
  byLine: classifyByLine(notionData.persons),
  byGeneration: classifyByGeneration(notionData.persons),
  familyTree: buildFamilyTree(notionData.persons)
};
```

#### **1-3. 가족 관계 트리 생성 로직**
```javascript
// data/family-tree.js
function buildFamilyTree(persons) {
  // 1세대부터 6세대까지 계층적 구조 생성
  // 아버지-어머니-자녀 관계 매핑
  // 배우자 관계 매핑
}
```

### **Phase 2: UI 컴포넌트 개발 (2시간)**

#### **2-1. 패밀리별 보기 메인 화면**
```html
<!-- ui/family.html -->
<div class="family-container">
  <!-- Line 탭 -->
  <div class="line-tabs">
    <button class="tab active" data-line="Line1">Line1 (74명)</button>
    <button class="tab" data-line="Line2">Line2 (34명)</button>
    <button class="tab" data-line="Line3">Line3 (41명)</button>
    <button class="tab" data-line="공통">공통 (3명)</button>
  </div>
  
  <!-- 세대 필터 -->
  <div class="generation-filters">
    <button class="filter active" data-generation="all">전체 (152명)</button>
    <button class="filter" data-generation="1">1세대 (3명)</button>
    <button class="filter" data-generation="2">2세대 (5명)</button>
    <button class="filter" data-generation="3">3세대 (16명)</button>
    <button class="filter" data-generation="4">4세대 (47명)</button>
    <button class="filter" data-generation="5">5세대 (76명)</button>
    <button class="filter" data-generation="6">6세대 (5명)</button>
  </div>
  
  <!-- 가족 트리 뷰 -->
  <div class="family-tree">
    <!-- 동적으로 생성 -->
  </div>
</div>
```

#### **2-2. 가족 트리 렌더링 로직**
```javascript
// ui/family.js
function renderFamilyTree(selectedLine, selectedGeneration) {
  // 선택된 Line과 세대에 따른 가족 트리 렌더링
  // 계층적 구조로 표시
  // 인물 카드 생성
}
```

#### **2-3. 반응형 스타일링**
```css
/* ui/family.css */
.family-container {
  max-width: 100%;
  padding: 20px;
}

.line-tabs, .generation-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 20px;
}

.family-tree {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.person-card {
  background: white;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
```

### **Phase 3: 필터링 및 네비게이션 로직 (1시간)**

#### **3-1. Line별 필터링**
```javascript
// system/family-filters.js
function filterByLine(line) {
  const filteredPersons = FAMILY_DATA.byLine[line] || [];
  updateStatistics(line, filteredPersons.length);
  renderFamilyTree(line, currentGeneration);
}
```

#### **3-2. 세대별 필터링**
```javascript
function filterByGeneration(generation) {
  const filteredPersons = generation === 'all' 
    ? getAllPersons() 
    : FAMILY_DATA.byGeneration[generation] || [];
  updateStatistics(currentLine, filteredPersons.length);
  renderFamilyTree(currentLine, generation);
}
```

#### **3-3. 통합 필터링**
```javascript
function applyFilters(line, generation) {
  let filteredPersons = FAMILY_DATA.byLine[line] || [];
  
  if (generation !== 'all') {
    filteredPersons = filteredPersons.filter(person => 
      person.generation === parseInt(generation)
    );
  }
  
  return filteredPersons;
}
```

### **Phase 4: 가족 트리 시각화 (1시간)**

#### **4-1. 계층적 구조 렌더링**
```javascript
// system/family-tree-renderer.js
function renderFamilyTree(persons) {
  const treeContainer = document.querySelector('.family-tree');
  treeContainer.innerHTML = '';
  
  // 1세대부터 순차적으로 렌더링
  const generation1 = persons.filter(p => p.generation === 1);
  generation1.forEach(person => {
    const personNode = createPersonNode(person);
    const children = getChildren(person, persons);
    children.forEach(child => {
      const childNode = createPersonNode(child);
      personNode.appendChild(childNode);
    });
    treeContainer.appendChild(personNode);
  });
}
```

#### **4-2. 인물 카드 생성**
```javascript
function createPersonNode(person) {
  const card = document.createElement('div');
  card.className = 'person-card';
  card.innerHTML = `
    <div class="person-info">
      <h3>${person.name}</h3>
      <p>${person.generation}세대 • ${person.line}</p>
      <p>${person.gender === 'M' ? '남성' : '여성'}</p>
    </div>
    <div class="person-status ${person.status}">
      ${getStatusIcon(person.status)}
    </div>
  `;
  return card;
}
```

#### **4-3. 관계선 표시**
```css
.person-card {
  position: relative;
}

.person-card::before {
  content: '';
  position: absolute;
  left: -20px;
  top: 50%;
  width: 20px;
  height: 2px;
  background: #ccc;
}

.person-card::after {
  content: '';
  position: absolute;
  left: -20px;
  top: 0;
  width: 2px;
  height: 100%;
  background: #ccc;
}
```

---

## 📱 **사용자 시나리오**

### **시나리오 1: Line1 가족 구성원 확인**
1. **패밀리별 보기** 화면 진입
2. **Line1 탭** 클릭 (74명 표시)
3. **전체 세대** 필터 선택
4. **Line1 가족 트리** 확인
5. **1세대 조정윤**부터 **6세대**까지 계층적 구조 확인

### **시나리오 2: 5세대 인물들만 확인**
1. **전체 Line** 선택
2. **5세대 필터** 클릭 (76명 표시)
3. **5세대 인물들만** 표시된 가족 트리 확인
4. **Line별 분포** 확인 (Line1, Line2, Line3)

### **시나리오 3: 특정 Line의 특정 세대 확인**
1. **Line2 탭** 클릭 (34명 표시)
2. **3세대 필터** 클릭
3. **Line2의 3세대 인물들**만 표시
4. **조영하, 조명하** 등 확인

---

## 🧪 **테스트 계획**

### **기능 테스트**
- [ ] Line 탭 전환 정상 작동
- [ ] 세대 필터 정상 작동
- [ ] 통합 필터링 정상 작동
- [ ] 가족 트리 렌더링 정상 작동
- [ ] 통계 정보 정확성 확인

### **데이터 테스트**
- [ ] 152명 데이터 모두 표시
- [ ] Line별 분포 정확성 (Line1: 74명, Line2: 34명, Line3: 41명, 공통: 3명)
- [ ] 세대별 분포 정확성 (1세대: 3명, 2세대: 5명, 3세대: 16명, 4세대: 47명, 5세대: 76명, 6세대: 5명)
- [ ] 가족 관계 정확성 확인

### **UI/UX 테스트**
- [ ] 모바일 반응형 디자인
- [ ] 터치 친화적 인터페이스
- [ ] 로딩 성능 최적화
- [ ] 접근성 확인

---

## 📊 **성능 최적화**

### **데이터 로딩 최적화**
```javascript
// 지연 로딩 구현
function loadFamilyData() {
  return new Promise((resolve) => {
    // 152명 데이터를 청크 단위로 로딩
    const chunks = chunkArray(FAMILY_DATA.persons, 50);
    loadChunksSequentially(chunks, resolve);
  });
}
```

### **렌더링 최적화**
```javascript
// 가상 스크롤링 구현
function renderVirtualTree(visiblePersons) {
  const container = document.querySelector('.family-tree');
  const visibleHeight = container.clientHeight;
  const itemHeight = 80; // 인물 카드 높이
  const visibleCount = Math.ceil(visibleHeight / itemHeight);
  
  // 보이는 영역만 렌더링
  renderVisibleItems(visiblePersons.slice(0, visibleCount));
}
```

---

## 🚀 **배포 및 통합**

### **기존 시스템과의 통합**
1. **1-3단계 모듈**과의 호환성 유지
2. **네비게이션 메뉴**에 패밀리별 보기 추가
3. **공통 스타일**과의 일관성 유지
4. **데이터 모듈** 공유

### **배포 체크리스트**
- [ ] 모든 기능 정상 작동 확인
- [ ] 152명 데이터 정확성 확인
- [ ] 모바일 호환성 확인
- [ ] 성능 최적화 확인
- [ ] 기존 기능 영향도 확인

---

## 📈 **향후 확장 계획**

### **단기 확장 (1-2개월)**
- **검색 기능** 추가 (이름, 세대, Line별 검색)
- **정렬 기능** 추가 (이름순, 세대순, 생년순)
- **상세 정보** 모달 추가

### **중기 확장 (3-6개월)**
- **관계도 시각화** 개선 (D3.js 활용)
- **인쇄 기능** 추가
- **데이터 내보내기** 기능

### **장기 확장 (6개월 이상)**
- **AI 기반 관계 추론** 기능
- **실시간 협업** 기능
- **다국어 지원**

---

## 🎯 **성공 기준**

### **기능적 성공 기준**
- ✅ 152명 데이터 모두 정상 표시
- ✅ Line별, 세대별 필터링 정상 작동
- ✅ 가족 트리 시각화 정상 작동
- ✅ 모바일 반응형 디자인 완성

### **성능적 성공 기준**
- ✅ 초기 로딩 시간 3초 이내
- ✅ 필터 전환 응답 시간 1초 이내
- ✅ 메모리 사용량 최적화
- ✅ 배터리 소모 최소화

### **사용자 경험 성공 기준**
- ✅ 직관적인 네비게이션
- ✅ 터치 친화적 인터페이스
- ✅ 빠른 데이터 접근
- ✅ 명확한 정보 표시

---

## 📝 **개발 일정**

### **총 개발 시간: 5시간**

| 단계 | 작업 내용 | 소요 시간 | 담당자 |
|------|-----------|-----------|--------|
| Phase 1 | 데이터 준비 및 구조 설계 | 1시간 | 서대리 |
| Phase 2 | UI 컴포넌트 개발 | 2시간 | 서대리 |
| Phase 3 | 필터링 및 네비게이션 로직 | 1시간 | 서대리 |
| Phase 4 | 가족 트리 시각화 | 1시간 | 서대리 |

### **마일스톤**
- **M1**: 데이터 구조 완성 (1시간 후)
- **M2**: UI 컴포넌트 완성 (3시간 후)
- **M3**: 필터링 로직 완성 (4시간 후)
- **M4**: 최종 통합 및 테스트 완료 (5시간 후)

---

## 🔍 **리스크 관리**

### **기술적 리스크**
- **데이터 크기**: 152명 데이터로 인한 성능 이슈
- **복잡한 관계**: 가족 관계 매핑의 복잡성
- **모바일 최적화**: 작은 화면에서의 가족 트리 표시

### **해결 방안**
- **지연 로딩**: 데이터를 청크 단위로 로딩
- **가상 스크롤링**: 보이는 영역만 렌더링
- **반응형 디자인**: 화면 크기에 따른 레이아웃 조정

---

## 📚 **참고 문서**

- **017**: 한양조씨 족보앱 사용자 시나리오 최종 확정본_V3.0
- **018**: 한양조씨 족보앱 UI 설계 최종 확정본_V3.0
- **019**: 한양조씨 족보앱 데이터 스키마 최종 확정본_V3.0
- **029**: 노션-JSON 동기화 프로세스 가이드 (V2.0)
- **033**: 노션 데이터베이스 접근 문제 해결 보고서

---

**문서 작성 완료일**: 2025년 1월 17일  
**개발 시작 예정일**: 2025년 1월 17일  
**개발 완료 예정일**: 2025년 1월 17일 (5시간 후)
