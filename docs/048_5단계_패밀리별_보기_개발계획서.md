# 5단계 패밀리별 보기 개발계획서

**문서 번호**: 048  
**작성일**: 2025년 9월 14일  
**작성자**: 서대리 (AI Assistant)  
**검토자**: 조대표님  
**버전**: 1.0  
**적용범위**: 한양조씨 족보앱 5단계 패밀리별 보기 기능

---

## 📋 **문서 개요**

### **목적**
- 5단계 패밀리별 보기 기능의 완전한 개발 계획 수립
- V2.0 방법론에 따른 체계적인 개발 방향성 제시
- 기존 구현된 기능의 개선 및 완성도 향상
- V4.0 단일소스 시스템과의 완전한 통합

### **배경**
- 4단계까지 완료된 개인검색, 세부정보, 촌수계산 기능
- V4.0 단일소스 시스템 구축 완료
- 기존 패밀리별 보기 기능의 부분적 구현 상태
- V2.0 방법론에 따른 표준화된 개발 프로세스 적용

---

## 🎯 **5단계 개발 목표**

### **1. 핵심 목표**
- **완전한 패밀리별 보기 기능** 구현
- **V4.0 단일소스 시스템**과의 완전한 통합
- **Line별/세대별 분류 표시** 완성
- **사용자 친화적 인터페이스** 제공

### **2. 기술적 목표**
- **데이터 소스 통합**: `window.CORE_DATA` 사용으로 통일
- **성능 최적화**: 152명 데이터 효율적 처리
- **반응형 디자인**: 모바일/데스크톱 최적화
- **접근성 향상**: 키보드/터치 제스처 지원

### **3. 사용자 경험 목표**
- **직관적인 네비게이션**: Line/세대별 쉬운 탐색
- **빠른 로딩**: 즉시 반응하는 인터페이스
- **상세 정보 접근**: 개인 세부정보로의 원클릭 이동
- **시각적 구분**: 생존/고인, 성별, 세대별 명확한 표시

---

## 📊 **현재 상태 분석**

### **1. 기존 구현 상태**

#### **✅ 완료된 기능**
- **기본 HTML 구조**: `app/family.html` 완성
- **CSS 스타일링**: `css/family.css` 완성
- **JavaScript 로직**: `js/family.js` 기본 구조 완성
- **Line 탭 시스템**: Line1, Line2, Line3, 공통 탭 구현
- **세대 필터**: 1-6세대 + 전체 필터 구현
- **통계 정보 표시**: 선택된 Line/세대/인물 수 표시
- **키보드/터치 제스처**: 네비게이션 지원

#### **❌ 미완성 기능**
- **데이터 소스 통합**: `FAMILY_DATA_BROWSER` 사용 (V2.0 미준수)
- **필드명 불일치**: `person.generation` vs `person.세대`
- **상세 정보 연결**: `showPersonDetail()` 함수 미구현
- **실제 데이터 연동**: 하드코딩된 통계 수치
- **V4.0 시스템 연동**: `window.CORE_DATA` 미사용

### **2. 문제점 분석**

#### **데이터 소스 문제**
```javascript
// 현재 문제: FAMILY_DATA_BROWSER 사용
if (typeof FAMILY_DATA_BROWSER !== 'undefined') {
    familyData = FAMILY_DATA_BROWSER;
}

// 해결 방안: window.CORE_DATA 사용
familyData = window.CORE_DATA;
```

#### **필드명 불일치 문제**
```javascript
// 현재 문제: 영어 필드명 사용
person.generation, person.status, person.gender

// 해결 방안: 노션 필드명 사용
person.세대, person.생존상태, person.성별
```

#### **상세 정보 연결 문제**
```javascript
// 현재 문제: alert로 임시 처리
function showPersonDetail(personId) {
    alert(`인물 ID: ${personId}의 상세 정보를 표시합니다.`);
}

// 해결 방안: 실제 상세 정보 페이지로 이동
function showPersonDetail(personId) {
    window.location.href = `detail.html?id=${personId}`;
}
```

---

## 🚀 **개발 계획**

### **Phase 1: 데이터 소스 통합 (1일)**

#### **1.1 V4.0 단일소스 시스템 적용**
- **목표**: `js/family.js`를 `window.CORE_DATA` 사용으로 변경
- **작업 내용**:
  ```javascript
  // 기존 코드 수정
  function loadFamilyData() {
      // V4.0 단일소스 시스템 적용
      familyData = window.CORE_DATA;
      console.log('패밀리 데이터 로드 완료 (V4.0):', familyData);
  }
  ```

#### **1.2 필드명 통일**
- **목표**: 모든 필드명을 노션과 일치시키기
- **작업 내용**:
  ```javascript
  // 필드명 변경
  person.generation → person.세대
  person.status → person.생존상태
  person.gender → person.성별
  person.line → person.Line1
  ```

#### **1.3 데이터 구조 검증**
- **목표**: 152명 데이터 완전 연동 확인
- **작업 내용**:
  - Line별 분류: Line1(74명), Line2(34명), Line3(41명), 공통(3명)
  - 세대별 분류: 1세대(3명), 2세대(5명), 3세대(16명), 4세대(47명), 5세대(76명), 6세대(5명)

### **Phase 2: 기능 완성 (1일)**

#### **2.1 상세 정보 연결**
- **목표**: 개인 카드 클릭 시 상세 정보 페이지로 이동
- **작업 내용**:
  ```javascript
  function showPersonDetail(personId) {
      console.log('인물 상세 정보 표시:', personId);
      window.location.href = `detail.html?id=${personId}`;
  }
  ```

#### **2.2 통계 정보 실시간 업데이트**
- **목표**: 선택된 조건에 따른 실시간 통계 표시
- **작업 내용**:
  ```javascript
  function updateStatistics() {
      const filteredPersons = getFilteredPersons();
      document.getElementById('display-count').textContent = `${filteredPersons.length}명`;
      
      // Line별 통계 업데이트
      updateLineCounts();
      // 세대별 통계 업데이트
      updateGenerationCounts();
  }
  ```

#### **2.3 인물 카드 표시 개선**
- **목표**: 생존상태, 성별, 한자명 등 정확한 정보 표시
- **작업 내용**:
  ```javascript
  function createPersonCard(person) {
      const statusIcon = person.생존상태 === '생존' ? '💚' : '💀';
      const statusClass = person.생존상태 === '생존' ? 'living' : 'deceased';
      const genderIcon = person.성별 === 'M' ? '👨' : '👩';
      
      return `
          <div class="person-card ${statusClass}" onclick="showPersonDetail('${person.id}')">
              <div class="person-info">
                  <div class="person-avatar">${person.name.charAt(0)}</div>
                  <div class="person-details">
                      <h3 class="person-name">${person.name}</h3>
                      ${person.한자명 ? `<p class="person-hanja">${person.한자명}</p>` : ''}
                      <div class="person-meta">
                          <span>${person.세대}세대</span>
                          <span>${person.Line1}</span>
                          <span>${person.성별 === 'M' ? '남성' : '여성'}</span>
                      </div>
                  </div>
              </div>
              <div class="person-status ${statusClass}">${statusIcon}</div>
          </div>
      `;
  }
  ```

### **Phase 3: 사용자 경험 개선 (1일)**

#### **3.1 반응형 디자인 최적화**
- **목표**: 모바일/데스크톱 최적화
- **작업 내용**:
  - 모바일: 카드형 레이아웃, 터치 제스처 최적화
  - 데스크톱: 그리드 레이아웃, 키보드 네비게이션 최적화
  - 태블릿: 중간 크기 최적화

#### **3.2 로딩 성능 최적화**
- **목표**: 빠른 로딩 및 반응성 향상
- **작업 내용**:
  ```javascript
  // 디바운스 함수로 렌더링 최적화
  const debouncedRender = debounce(renderFamilyTree, 100);
  
  // 가상 스크롤링 (대용량 데이터용)
  function implementVirtualScrolling() {
      // 152명 데이터에 대한 가상 스크롤링 구현
  }
  ```

#### **3.3 접근성 향상**
- **목표**: 키보드/스크린 리더 지원
- **작업 내용**:
  - ARIA 라벨 추가
  - 키보드 네비게이션 개선
  - 색상 대비 최적화
  - 포커스 관리 개선

### **Phase 4: 테스트 및 검증 (1일)**

#### **4.1 기능 테스트**
- **목표**: 모든 기능 정상 작동 확인
- **테스트 항목**:
  - Line 탭 전환 (Line1, Line2, Line3, 공통)
  - 세대 필터 전환 (1-6세대, 전체)
  - 인물 카드 클릭 → 상세 정보 이동
  - 통계 정보 실시간 업데이트
  - 키보드/터치 제스처

#### **4.2 데이터 정확성 검증**
- **목표**: 152명 데이터 정확성 확인
- **검증 항목**:
  - Line별 인원 수 정확성
  - 세대별 인원 수 정확성
  - 개인 정보 표시 정확성
  - 생존상태 표시 정확성

#### **4.3 성능 테스트**
- **목표**: 로딩 속도 및 반응성 확인
- **테스트 항목**:
  - 초기 로딩 시간
  - 탭 전환 속도
  - 필터 적용 속도
  - 메모리 사용량

---

## 🔧 **기술적 구현 세부사항**

### **1. 데이터 구조 설계**

#### **V4.0 단일소스 시스템 적용**
```javascript
// js/family.js 수정
function loadFamilyData() {
    try {
        // V4.0 단일소스 시스템: window.CORE_DATA 사용
        familyData = window.CORE_DATA;
        
        if (!familyData || !familyData.persons) {
            throw new Error('CORE_DATA가 로드되지 않았습니다');
        }
        
        console.log('패밀리 데이터 로드 완료 (V4.0):', familyData);
        
        // UI 업데이트
        updateStatistics();
        renderFamilyTree();
        hideLoadingIndicator();
        
    } catch (error) {
        console.error('패밀리 데이터 로드 실패:', error);
        showError('데이터를 불러오는데 실패했습니다.');
    }
}
```

#### **필드명 통일**
```javascript
// 필드명 매핑 테이블
const FIELD_MAPPING = {
    // 기존 → 새로운 (노션 필드명)
    'generation': '세대',
    'status': '생존상태',
    'gender': '성별',
    'line': 'Line1',
    'hanja': '한자명',
    'birthDate': '생년'
};
```

### **2. 통계 시스템 구현**

#### **실시간 통계 업데이트**
```javascript
function updateStatistics() {
    if (!familyData) return;
    
    // 선택된 Line과 세대에 따른 필터링된 인물 수 계산
    const filteredPersons = getFilteredPersons();
    
    // UI 업데이트
    document.getElementById('selected-line').textContent = currentLine;
    document.getElementById('selected-generation').textContent = 
        currentGeneration === 'all' ? '전체' : `${currentGeneration}세대`;
    document.getElementById('display-count').textContent = `${filteredPersons.length}명`;
    
    // Line별 통계 업데이트
    updateLineCounts();
    // 세대별 통계 업데이트
    updateGenerationCounts();
}

function updateLineCounts() {
    const lineCounts = {
        'Line1': familyData.persons.filter(p => p.Line1 === 'Line1').length,
        'Line2': familyData.persons.filter(p => p.Line1 === 'Line2').length,
        'Line3': familyData.persons.filter(p => p.Line1 === 'Line3').length,
        '공통': familyData.persons.filter(p => p.Line1 === '공통').length
    };
    
    // 탭의 카운트 업데이트
    Object.keys(lineCounts).forEach(line => {
        const tab = document.querySelector(`[data-line="${line}"] .count`);
        if (tab) {
            tab.textContent = `(${lineCounts[line]}명)`;
        }
    });
}
```

### **3. 인물 카드 시스템**

#### **개선된 인물 카드 생성**
```javascript
function createPersonCard(person) {
    const statusIcon = person.생존상태 === '생존' ? '💚' : '💀';
    const statusClass = person.생존상태 === '생존' ? 'living' : 'deceased';
    const genderIcon = person.성별 === 'M' ? '👨' : '👩';
    
    return `
        <div class="person-card ${statusClass}" onclick="showPersonDetail('${person.id}')">
            <div class="person-info">
                <div class="person-avatar">${person.name.charAt(0)}</div>
                <div class="person-details">
                    <h3 class="person-name">${person.name}</h3>
                    ${person.한자명 ? `<p class="person-hanja">${person.한자명}</p>` : ''}
                    <div class="person-meta">
                        <span class="generation">${person.세대}세대</span>
                        <span class="line">${person.Line1}</span>
                        <span class="gender">${person.성별 === 'M' ? '남성' : '여성'}</span>
                        ${person.생년 ? `<span class="birth">${person.생년}년</span>` : ''}
                    </div>
                </div>
            </div>
            <div class="person-status ${statusClass}">
                ${statusIcon}
            </div>
        </div>
    `;
}
```

### **4. 성능 최적화**

#### **디바운스 함수**
```javascript
// 성능 최적화: 디바운스 함수
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// 렌더링 최적화: 디바운스된 렌더링
const debouncedRender = debounce(renderFamilyTree, 100);

// 윈도우 리사이즈 시 반응형 업데이트
window.addEventListener('resize', debouncedRender);
```

#### **가상 스크롤링 (필요시)**
```javascript
// 대용량 데이터용 가상 스크롤링
function implementVirtualScrolling() {
    const container = document.getElementById('family-tree');
    const itemHeight = 80; // 카드 높이
    const visibleItems = Math.ceil(container.clientHeight / itemHeight);
    
    // 현재 보이는 아이템만 렌더링
    function renderVisibleItems() {
        const scrollTop = container.scrollTop;
        const startIndex = Math.floor(scrollTop / itemHeight);
        const endIndex = Math.min(startIndex + visibleItems, filteredPersons.length);
        
        // 가시 영역의 아이템만 렌더링
        const visiblePersons = filteredPersons.slice(startIndex, endIndex);
        // ... 렌더링 로직
    }
}
```

---

## 📋 **개발 일정**

### **Week 1: 데이터 소스 통합 및 기능 완성**

#### **Day 1: 데이터 소스 통합**
- **오전**: V4.0 단일소스 시스템 적용
- **오후**: 필드명 통일 및 데이터 구조 검증

#### **Day 2: 기능 완성**
- **오전**: 상세 정보 연결 구현
- **오후**: 통계 정보 실시간 업데이트

#### **Day 3: 사용자 경험 개선**
- **오전**: 반응형 디자인 최적화
- **오후**: 로딩 성능 최적화

#### **Day 4: 테스트 및 검증**
- **오전**: 기능 테스트 및 데이터 정확성 검증
- **오후**: 성능 테스트 및 최종 검토

### **Week 2: 추가 기능 및 최적화**

#### **Day 5-7: 추가 기능 구현**
- **고급 필터링**: 생존상태, 성별별 필터
- **검색 기능**: 패밀리별 보기 내 검색
- **정렬 기능**: 이름, 세대, 생년별 정렬

#### **Day 8-10: 최적화 및 문서화**
- **성능 최적화**: 가상 스크롤링, 캐싱
- **문서화**: 사용자 가이드, 개발 문서
- **최종 테스트**: 전체 시스템 통합 테스트

---

## 🎯 **성공 기준**

### **1. 기능적 성공 기준**
- ✅ **Line별 분류**: Line1, Line2, Line3, 공통 정확한 분류
- ✅ **세대별 분류**: 1-6세대 정확한 분류
- ✅ **상세 정보 연결**: 개인 카드 클릭 시 상세 정보 페이지 이동
- ✅ **통계 정보**: 실시간 정확한 통계 표시
- ✅ **데이터 정확성**: 152명 데이터 100% 정확 표시

### **2. 기술적 성공 기준**
- ✅ **V4.0 시스템 통합**: `window.CORE_DATA` 완전 사용
- ✅ **필드명 일치**: 노션 필드명과 100% 일치
- ✅ **성능 최적화**: 로딩 시간 1초 이내
- ✅ **반응형 디자인**: 모바일/데스크톱 최적화
- ✅ **접근성**: 키보드/터치 제스처 완벽 지원

### **3. 사용자 경험 성공 기준**
- ✅ **직관적 네비게이션**: 쉬운 Line/세대 전환
- ✅ **빠른 반응성**: 즉시 반응하는 인터페이스
- ✅ **시각적 명확성**: 생존/고인, 성별, 세대별 명확한 구분
- ✅ **일관성**: 다른 기능과 일관된 사용자 경험

---

## 🚨 **위험 요소 및 대응 방안**

### **1. 데이터 불일치 위험**
- **위험**: `window.CORE_DATA`와 기존 데이터 구조 불일치
- **대응**: 단계적 마이그레이션, 데이터 검증 스크립트 작성

### **2. 성능 저하 위험**
- **위험**: 152명 데이터로 인한 렌더링 지연
- **대응**: 가상 스크롤링, 디바운스 함수, 지연 로딩

### **3. 호환성 위험**
- **위험**: 기존 기능과의 호환성 문제
- **대응**: 점진적 업데이트, 백업 시스템 구축

### **4. 사용자 경험 위험**
- **위험**: 복잡한 인터페이스로 인한 사용성 저하
- **대응**: 사용자 테스트, 단계적 기능 공개

---

## 📊 **예상 결과물**

### **1. 완성된 기능**
- **패밀리별 보기**: Line/세대별 완전한 분류 표시
- **상세 정보 연결**: 개인 세부정보로의 원클릭 이동
- **실시간 통계**: 정확한 인원 수 및 분류 통계
- **반응형 인터페이스**: 모든 디바이스에서 최적화된 경험

### **2. 기술적 성과**
- **V4.0 시스템 완전 통합**: 모든 모듈이 단일 소스 사용
- **성능 최적화**: 빠른 로딩 및 반응성
- **코드 품질**: V2.0 방법론 100% 준수
- **확장성**: 새로운 기능 추가 용이성

### **3. 사용자 경험 향상**
- **직관적 탐색**: 쉬운 Line/세대별 탐색
- **빠른 접근**: 개인 정보로의 즉시 이동
- **시각적 명확성**: 명확한 정보 구분
- **일관된 경험**: 전체 앱과 일관된 사용자 경험

---

## 🎯 **결론**

### **핵심 목표**
5단계 패밀리별 보기 개발을 통해 **완전한 Line/세대별 분류 표시 기능**을 구현하고, **V4.0 단일소스 시스템**과의 완전한 통합을 달성하여 **일관되고 직관적인 사용자 경험**을 제공합니다.

### **기대 효과**
- **기능 완성도**: 패밀리별 보기 기능의 완전한 구현
- **시스템 통합**: V4.0 단일소스 시스템의 완전한 적용
- **사용자 경험**: 직관적이고 빠른 가족 정보 탐색
- **확장성**: 향후 기능 확장을 위한 견고한 기반

### **다음 단계**
5단계 완료 후 **6단계 정보 내보내기** 개발을 위한 견고한 기반이 마련되며, 전체 10단계 개발 계획의 60% 완료를 달성하게 됩니다.

---

**작성 완료일**: 2025년 9월 14일  
**다음 검토 예정일**: 조대표님 검토 후  
**관련 문서**: 044번 현재단계 및 향후 단계, 045번 4단계 개인검색 기능 완료 보고서, 046번 개인별 세부정보 표시모듈 작동절차와 기능
